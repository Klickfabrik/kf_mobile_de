<html xmlns:f="https://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" data-namespace-typo3-fluid="true">
<f:variable name="options" value="{vehicle.options}" />
<f:variable name="vehicle" value="{vehicle.data}" />
<f:if condition="{vehicle}">
	<f:then>
		<div class="view-single">
			<div class="header">
				<div class="row">
					<div class="col-xs-12">
						<h2>{vehicle.modelDescription}</h2>
					</div>
				</div>
				<div class="row">
					<div class="col-xs-12">
						<f:render partial="Vehicle/Item/ButtonGoback" arguments="{_all}" />
					</div>
				</div>
			</div>

			<f:if condition="{vehicle.images}">
				<div class="images">
					<div class="row">
						<div class="large col-xs-12 col-sm-6">
							<f:for each="{vehicle.images}" as="image" iteration="iterator">
								<f:if condition="{iterator.index} == 0">
									<f:render partial="Vehicle/Image/Single" arguments="{_all}" />
								</f:if>
							</f:for>
						</div>
						<div class="small col-xs-12 col-sm-6">
							<div class="row">
								<f:for each="{vehicle.images}" as="image" iteration="iterator">
									<div class="col-xs-2 col-sm-3">
										<div class="item">
											<f:render partial="Vehicle/Image/Single" arguments="{_all}" />
										</div>
									</div>
								</f:for>
							</div>
						</div>
						<script type="text/javascript">
                            var images;
                            (function ($, root, undefined) {
                                images = $('.images');
                                initSmallGallery();
                            })(jQuery, this);

                            function initSmallGallery(){
                                var small = images.find(".small"),
                                    large = images.find(".large");

                                small.find('.item').eq(0).addClass("act");
                                toggleSmallGallery(large,small);
                            }
                            function toggleSmallGallery(large,small){
                                small.find(".item").hover(function(){
                                    small.find(".item.act").removeClass("act");

                                    var that = $(this);
                                    that.addClass("act");
                                    large.find("img").attr("src",that.find("img").attr("src"));
                                });
                            }
						</script>
					</div>
				</div>
			</f:if>

			<div class="wrap_price">
				<div class="row">
					<div class="col-xs-12 col-sm-6">
						<h3>Fahrzeugpreis</h3>
						<div class="price">
							€<f:format.number decimals="0" decimalSeparator="," thousandsSeparator=".">{vehicle.price}</f:format.number>,-
							<div class="mwst">(inkl. 19% MwSt.)</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6">
						<h3>Anfrage</h3>
						<f:render partial="Vehicle/Item/ButtonMailSingle" arguments="{_all}" />
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-12 col-sm-6">
					<f:if condition="{options.{vehicle.importKey}}">
						<div class="wrap_specifics">
							<h3>Fahrzeugdaten</h3>
							<div class="specifics">
								<table class="table table-striped table-small">
									<tbody>
									<f:for each="{options.{vehicle.importKey}}" as="item" key="translate">
										<tr>
											<td>{translate}</td>
											<f:if condition="{translate} == 'Erstzulassung'">
												<f:then><td><f:format.date format="%d.%m.%Y">{item}</f:format.date></td></f:then>
												<f:else><td>{item}</td></f:else>
											</f:if>
										</tr>
									</f:for>
									</tbody>
								</table>
							</div>
						</div>
					</f:if>
				</div>
				<div class="col-xs-12 col-sm-6">
					<f:if condition="{vehicle.seller}">
						<div class="wrap_seller">
							<h3>Standort</h3>
							<div class="seller">
								<p><strong>{vehicle.seller.companyName}</strong><br/>
									{vehicle.seller.street}<br/>
									{vehicle.seller.zipcode} {vehicle.seller.city}</p>
								<p>{vehicle.seller.email}</p>
							</div>
							<div class="embed-responsive embed-responsive-16by9">
								<f:render partial="Seller/GoogleMaps/MapsSingle" arguments="{_all}" />
							</div>
						</div>
					</f:if>
				</div>
			</div>

			<f:if condition="{energy_efficiency}">
				<hr />
				<div class="wrap_co2">
					<h3>Umwelt-, Verbrauchs- und Emissionsdaten</h3>
					<div class="row">
						<div class="col-xs-12 col-sm-6">
							<table class="table table-size">
								<tr>
									<td>Kraftstoffverbr. innerorts</td>
									<td>{energy_efficiency.inner}</td>
								</tr>
								<tr>
									<td>Kraftstoffverbr. außerorts</td>
									<td>{energy_efficiency.outer}</td>
								</tr>
								<tr>
									<td>Kraftstoffverbr. kombinert</td>
									<td>{energy_efficiency.combined}</td>
								</tr>
								<tr>
									<td>CO2-Emissionen kombinert</td>
									<td>{energy_efficiency.co2-emission}</td>
								</tr>
								<tr>
									<td>Schadstoffklasse</td>
									<td>{energy_efficiency.emissionClass}</td>
								</tr>
								<tr>
									<td>Partikelfilter</td>
									<td>{f:if(condition: '{energy_efficiency.envkv-compliant} == 1', then: 'ja', else: 'nein')}</td>
								</tr>
								<tr>
									<td>Effiziensklasse</td>
									<td>{energy_efficiency.emission-sticker}</td>
								</tr>
							</table>
						</div>
						<f:if condition="{energy_efficiency.sticker_img}">
							<div class="col-xs-12 col-sm-6">
								<f:image src="{f:uri.resource(path:'Images/EURO{energy_efficiency.sticker_img}.png')}" class="img-responsive" title="{energy_efficiency.emissionClass}" maxWidth="300" />
							</div>
						</f:if>
					</div>
				</div>
			</f:if>

			<f:if condition="{vehicle.features}">
				<hr />
				<div class="wrap_features">
					<h3>Serienausstattung und Sonderausstattung</h3>
					<div class="features">
						<ul>
							<f:for each="{vehicle.features}" as="item" key="translate" iteration="iterator">
								<li>{item.description}</li>
							</f:for>
						</ul>
					</div>
				</div>
			</f:if>

			<f:render partial="Vehicle/Item/ButtonGoback" arguments="{_all}" />
		</div>
	</f:then>
	<f:else>
		<f:render partial="Vehicle/NothingFound" arguments="{_all}" />
	</f:else>
</f:if>
</html>